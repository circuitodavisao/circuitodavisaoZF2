<?php

use Application\Controller\Helper\Constantes;
use Application\View\Helper\BotaoSimples;

$form = $this->formulario;
$form->prepare();
$form->setAttribute(Constantes::$ACTION, $this->url(Constantes::$ROUTE_CADASTRO, array(Constantes::$PAGINA => Constantes::$PAGINA_GERAR_CRACHA)));
$form->setAttribute('target', '_blanck');
echo $this->form()->openTag($form);
?>
<style type="text/css">
    th {
        text-align: center;
    }
</style>
<div class="mw1000 center-block p5 mt50">
    <div class="row ">
        <div id="content" class="animated fadeIn">
            <blockquote class="blockquote-primary">
                <p>Selecione para imprimir os crachás</p>
            </blockquote>
            <div class="panel panel-primary heading-border">
                <div class="panel-body bg-light p5">
                    <?php
                    $htmlBotaoGerar .= '<div class="text-center m20">';
                    $funcao = $this->funcaoOnClick('this.form.submit()');
                    $htmlBotaoGerar .= $this->botaoSimples('Gerar Crachá', $funcao, '', BotaoSimples::posicaoAoCentro);
                    $htmlBotaoGerar .= '</div>';
                    echo $htmlBotaoGerar;

                    if ($relatorioRevisionistas = $this->relatorio['revisionistas']) {
                        echo '<table class="text-center table table-condensed table-hover bg-light mt15">';
                        echo '<thead>';
                        echo '<tr class="dark">';
                        echo '<th>Inscrição</th>';
                        echo '<th>Revisionista</th>';
                        echo '<th>Time</th>';
                        echo '<th><input type="checkbox" onclick="marcarTodos(this);"/></th>';
                        echo '</tr>';
                        echo '</thead>';
                        echo '<tbody>';
                        foreach ($relatorioRevisionistas as $relatorio) {
                            echo '<tr>';
                            echo '<td>' . $relatorio->getId() . '</td>';
                            echo '<td>' . $relatorio->getPessoa()->getNome() . '</td>';
                            echo '<td>' . $relatorio->getPessoa()->getGrupoPessoaAtivo()->getGrupo()->getEntidadeAtiva()->infoEntidade() . '</td>';
                            echo '<td><input type="checkbox" id="revisionista' . $relatorio->getId() . '" name="revisionista' . $relatorio->getId() . '" value="' . $relatorio->getId() . '"/></td>';
                            echo '</tr>';
                        }
                        echo '</tbody>';
                        echo '</table>';
                    }
                    if ($relatorioLideres = $this->relatorio['lideres']) {
                        echo '<table class="text-center table table-condensed table-hover bg-light mt15">';
                        echo '<thead>';
                        echo '<tr class="dark">';
                        echo '<th>Inscrição</th>';
                        echo '<th>Líder</th>';
                        echo '<th>Time</th>';
                        echo '<th><input type="checkbox" onclick="marcarTodos(this);"/></th>';
                        echo '</tr>';
                        echo '</thead>';
                        echo '<tbody>';
                        foreach ($relatorioLideres as $relatorio) {
                            echo '<tr>';
                            echo '<td>' . $relatorio->getId() . '</td>';
                            echo '<td>' . $relatorio->getPessoa()->getNome() . '</td>';
                            echo '<td>' . $relatorio->getPessoa()->getResponsabilidadesAtivas()[0]->getGrupo()->getEntidadeAtiva()->infoEntidade() . '</td>';
                            echo '<td><input type="checkbox" id="lider' . $relatorio->getId() . '" name="lider' . $relatorio->getId() . '" value="' . $relatorio->getId() . '"/></td>';
                            echo '</tr>';
                        }
                        echo '</tbody>';
                        echo '</table>';
                    }
                    echo $htmlBotaoGerar;
                    ?>
                </div>  
            </div>
        </div>
    </div>
</div>
<?php
echo $this->form()->closeTag();
